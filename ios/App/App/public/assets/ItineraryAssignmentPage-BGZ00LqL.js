import{r as f,j as e,X as z,B as q,D as P,F as $,G as k,s as w,t as A,A as O,u as L}from"./index-CAsyng-G.js";import{C as K,U as T}from"./user-D5s9iwuG.js";import{C as F}from"./crown-DXGOoHaJ.js";import{P as U}from"./plus-CmGY8coD.js";import{f as H,C as V}from"./calendar-BbT1q-ev.js";import{d as E}from"./demoModeService-C5DiNBaU.js";import{F as W}from"./filter-CGCfNQCb.js";import{C as Q}from"./clock-z7hIZNmF.js";import{M as G}from"./map-pin-BpJQ3jXK.js";import{A as J}from"./arrow-left-DsyQ2ZDs.js";import{U as X}from"./users-DV9oPzUN.js";import{C as Y}from"./calendar-B2WMmvpa.js";import"./button-_Pv0MPf0.js";import"./chevron-left-DBJ6HR3b.js";import"./chevron-right-ubVvME2N.js";const M=[{id:"accommodations",name:"Accommodations",icon:"ðŸ¨",description:"Hotels, rentals, and lodging",color:"bg-blue-500"},{id:"food",name:"Food & Dining",icon:"ðŸ½ï¸",description:"Restaurants, cafes, and meals",color:"bg-red-500"},{id:"transportation",name:"Transportation",icon:"ðŸš—",description:"Flights, cars, and local transport",color:"bg-green-500"},{id:"fitness",name:"Fitness & Activities",icon:"ðŸ’ª",description:"Sports, hiking, and wellness",color:"bg-purple-500"},{id:"nightlife",name:"Nightlife & Entertainment",icon:"ðŸŒ™",description:"Bars, clubs, and evening fun",color:"bg-indigo-500"},{id:"attractions",name:"Attractions & Sightseeing",icon:"ðŸŽ¯",description:"Museums, landmarks, and tours",color:"bg-yellow-500"},{id:"budget",name:"Budget & Expenses",icon:"ðŸ’°",description:"Costs, payments, and financial planning",color:"bg-emerald-500"}],Z=({tripMembers:r,assignments:t,onAssignmentChange:s})=>{var v;const[n,d]=f.useState(null),[a,c]=f.useState(!1),x=i=>t.find(o=>o.categoryId===i),h=(i,o,g=!1)=>{const m=[...t],p=m.findIndex(u=>u.categoryId===i);if(p>=0){const u=m[p],b=r.find(N=>N.id===o);if(!b)return;u.assignedUsers.some(N=>N.id===o)||u.assignedUsers.push(b),g&&(u.leadUserId=o)}else{const u=r.find(b=>b.id===o);if(!u)return;m.push({categoryId:i,assignedUsers:[u],leadUserId:g?o:void 0})}s(m)},l=(i,o)=>{var p;const g=[...t],m=g.findIndex(u=>u.categoryId===i);if(m>=0){const u=g[m];u.assignedUsers=u.assignedUsers.filter(b=>b.id!==o),u.leadUserId===o&&(u.leadUserId=(p=u.assignedUsers[0])==null?void 0:p.id),u.assignedUsers.length===0&&g.splice(m,1)}s(g)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white/5 backdrop-blur-md border border-white/10 rounded-2xl p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-3",children:"Assign Category Responsibilities"}),e.jsx("p",{className:"text-gray-300",children:"Assign team members to be responsible for different aspects of your trip. The person with the crown icon is the category lead and has primary responsibility."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:M.map(i=>{const o=x(i.id),g=(o==null?void 0:o.assignedUsers.length)||0;return e.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl p-6 hover:border-yellow-500/30 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"text-3xl",children:i.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:i.name}),e.jsx("p",{className:"text-sm text-gray-400",children:i.description})]})]}),e.jsx("div",{className:"mb-4",children:g>0?e.jsxs("div",{className:"flex items-center gap-2 text-green-400 text-sm",children:[e.jsx(K,{size:16}),e.jsxs("span",{children:[g," ",g===1?"person":"people"," assigned"]})]}):e.jsx("div",{className:"text-gray-400 text-sm",children:"No one assigned yet"})}),o&&o.assignedUsers.length>0&&e.jsx("div",{className:"space-y-2 mb-4",children:o.assignedUsers.map(m=>e.jsxs("div",{className:"flex items-center justify-between bg-white/5 rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:m.avatar,alt:m.name,className:"w-6 h-6 rounded-full"}),e.jsx("span",{className:"text-white text-sm",children:m.name}),o.leadUserId===m.id&&e.jsx(F,{size:14,className:"text-yellow-500"})]}),e.jsx("button",{onClick:()=>l(i.id,m.id),className:"text-gray-400 hover:text-red-400 text-xs",children:"Remove"})]},m.id))}),e.jsxs("button",{onClick:()=>{d(i.id),c(!0)},className:"w-full flex items-center justify-center gap-2 bg-yellow-500/20 hover:bg-yellow-500/30 text-yellow-400 py-2 rounded-lg transition-colors border border-yellow-500/30",children:[e.jsx(U,{size:16}),e.jsx("span",{children:"Assign People"})]})]},i.id)})}),a&&n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl p-6 w-full max-w-md",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-4",children:["Assign to ",(v=M.find(i=>i.id===n))==null?void 0:v.name]}),e.jsx("div",{className:"space-y-3 mb-6",children:r.map(i=>{const o=x(n),g=o==null?void 0:o.assignedUsers.some(p=>p.id===i.id),m=(o==null?void 0:o.leadUserId)===i.id;return e.jsxs("div",{className:"flex items-center justify-between bg-gray-800 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:i.avatar,alt:i.name,className:"w-8 h-8 rounded-full"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:i.name}),e.jsx("div",{className:"text-gray-400 text-sm",children:i.email})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[g&&e.jsx("button",{onClick:()=>h(n,i.id,!0),className:`p-1 rounded ${m?"text-yellow-500":"text-gray-400 hover:text-yellow-500"}`,title:"Make lead",children:e.jsx(F,{size:16})}),e.jsx("button",{onClick:()=>g?l(n,i.id):h(n,i.id),className:`p-1 rounded ${g?"text-red-400 hover:text-red-300":"text-green-400 hover:text-green-300"}`,children:g?e.jsx(T,{size:16}):e.jsx(U,{size:16})})]})]},i.id)})}),e.jsx("div",{className:"flex gap-3",children:e.jsx("button",{onClick:()=>c(!1),className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-2 rounded-lg transition-colors",children:"Done"})})]})})]})},ee=({category:r,isOpen:t,onClose:s,onSubmit:n,selectedDate:d})=>{const[a,c]=f.useState({title:"",time:"",location:"",description:"",checkInTime:"",checkOutTime:"",bookingReference:"",cuisine:"",dietaryRestrictions:"",priceRange:"",duration:"",difficulty:"",dressCode:"",coverCharge:"",ageRequirement:""}),x=l=>{l.preventDefault(),n(a),c({title:"",time:"",location:"",description:"",checkInTime:"",checkOutTime:"",bookingReference:"",cuisine:"",dietaryRestrictions:"",priceRange:"",duration:"",difficulty:"",dressCode:"",coverCharge:"",ageRequirement:""})},h=()=>{switch(r.id){case"accommodations":return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"time",placeholder:"Check-in time",value:a.checkInTime,onChange:l=>c({...a,checkInTime:l.target.value}),className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-yellow-500"}),e.jsx("input",{type:"time",placeholder:"Check-out time",value:a.checkOutTime,onChange:l=>c({...a,checkOutTime:l.target.value}),className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-yellow-500"})]}),e.jsx("input",{type:"text",placeholder:"Booking reference",value:a.bookingReference,onChange:l=>c({...a,bookingReference:l.target.value}),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"})]});case"food":return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",placeholder:"Cuisine type",value:a.cuisine,onChange:l=>c({...a,cuisine:l.target.value}),className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"}),e.jsxs("select",{value:a.priceRange,onChange:l=>c({...a,priceRange:l.target.value}),className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-yellow-500",children:[e.jsx("option",{value:"",children:"Price range"}),e.jsx("option",{value:"$",children:"$ (Budget)"}),e.jsx("option",{value:"$$",children:"$$ (Moderate)"}),e.jsx("option",{value:"$$$",children:"$$$ (Expensive)"}),e.jsx("option",{value:"$$$$",children:"$$$$ (Very Expensive)"})]})]}),e.jsx("input",{type:"text",placeholder:"Dietary restrictions",value:a.dietaryRestrictions,onChange:l=>c({...a,dietaryRestrictions:l.target.value}),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"})]});case"transportation":return e.jsx("input",{type:"text",placeholder:"Booking reference / Flight number",value:a.bookingReference,onChange:l=>c({...a,bookingReference:l.target.value}),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"});case"fitness":return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",placeholder:"Duration (e.g., 2 hours)",value:a.duration,onChange:l=>c({...a,duration:l.target.value}),className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"}),e.jsxs("select",{value:a.difficulty,onChange:l=>c({...a,difficulty:l.target.value}),className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-yellow-500",children:[e.jsx("option",{value:"",children:"Difficulty"}),e.jsx("option",{value:"easy",children:"Easy"}),e.jsx("option",{value:"moderate",children:"Moderate"}),e.jsx("option",{value:"hard",children:"Hard"}),e.jsx("option",{value:"expert",children:"Expert"})]})]})});case"nightlife":return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",placeholder:"Dress code",value:a.dressCode,onChange:l=>c({...a,dressCode:l.target.value}),className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"}),e.jsx("input",{type:"text",placeholder:"Cover charge",value:a.coverCharge,onChange:l=>c({...a,coverCharge:l.target.value}),className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"})]}),e.jsx("input",{type:"text",placeholder:"Age requirement",value:a.ageRequirement,onChange:l=>c({...a,ageRequirement:l.target.value}),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"})]});default:return null}};return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-2xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:r.icon}),e.jsxs("h3",{className:"text-xl font-semibold text-white",children:["Add ",r.name," Event"]})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white p-1 rounded-lg hover:bg-gray-800",children:e.jsx(z,{size:20})})]}),d&&e.jsxs("div",{className:"mb-4 text-sm text-gray-400",children:["Date: ",d.toLocaleDateString()]}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Event title",value:a.title,onChange:l=>c({...a,title:l.target.value}),required:!0,className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"}),e.jsx("input",{type:"time",value:a.time,onChange:l=>c({...a,time:l.target.value}),required:!0,className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-yellow-500"}),e.jsx("input",{type:"text",placeholder:"Location",value:a.location,onChange:l=>c({...a,location:l.target.value}),className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500"}),h(),e.jsx("textarea",{placeholder:"Description (optional)",value:a.description,onChange:l=>c({...a,description:l.target.value}),rows:3,className:"w-full bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500 resize-none"}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-yellow-500 hover:bg-yellow-600 text-black font-medium py-2 rounded-lg transition-colors",children:"Add Event"}),e.jsx("button",{type:"button",onClick:s,className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-2 rounded-lg transition-colors",children:"Cancel"})]})]})]})}):null};class te{getStorageKey(t){return`calendar_events_${t}`}async getEvents(t){try{return await q(this.getStorageKey(t),[])}catch(s){return console.error("Error loading calendar events from storage:",s),[]}}async saveEvents(t,s){try{await P(this.getStorageKey(t),s)}catch(n){console.error("Error saving calendar events to storage:",n)}}async createEvent(t){const s=await this.getEvents(t.trip_id),n={id:`demo-event-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,trip_id:t.trip_id,title:t.title,description:t.description,start_time:t.start_time,end_time:t.end_time,location:t.location,event_category:t.event_category||"other",include_in_itinerary:t.include_in_itinerary??!0,source_type:t.source_type||"manual",source_data:t.source_data||{},created_by:"demo-user",created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return s.push(n),s.sort((d,a)=>new Date(d.start_time).getTime()-new Date(a.start_time).getTime()),await this.saveEvents(t.trip_id,s),n}async updateEvent(t,s,n){const d=await this.getEvents(t),a=d.findIndex(x=>x.id===s);if(a===-1)return null;const c={...d[a],...n,updated_at:new Date().toISOString()};return d[a]=c,d.sort((x,h)=>new Date(x.start_time).getTime()-new Date(h.start_time).getTime()),await this.saveEvents(t,d),c}async deleteEvent(t,s){const n=await this.getEvents(t),d=n.filter(a=>a.id!==s);return d.length!==n.length?(await this.saveEvents(t,d),!0):!1}async clearEvents(t){await $(this.getStorageKey(t))}async clearAllDemoEvents(){const t=[];for(let s=0;s<(await k.getItem("length")?parseInt(await k.getItem("length")||"0"):0);s++){const n=`calendar_events_${s}`;await k.getItem(n)&&t.push(n)}for(const s of t)s.startsWith("calendar_events_")&&await $(s)}}const _=new te,j={async createEvent(r){try{if(await E.isDemoModeEnabled())return await _.createEvent(r);const{data:{user:s}}=await w.auth.getUser();if(!s)throw new Error("User not authenticated");const{data:n,error:d}=await w.rpc("create_event_with_conflict_check",{p_trip_id:r.trip_id,p_title:r.title,p_description:r.description||"",p_location:r.location||"",p_start_time:r.start_time,p_end_time:r.end_time||null,p_created_by:s.id});if(d)throw d;const{data:a,error:c}=await w.from("trip_events").select("*").eq("id",n).single();if(c)throw c;return a}catch(t){return console.error("Error creating event:",t),null}},async getTripEvents(r){try{if(await E.isDemoModeEnabled())return await _.getEvents(r);const{data:s,error:n}=await w.from("trip_events").select("*").eq("trip_id",r).order("start_time",{ascending:!0});if(n)throw n;return s||[]}catch(t){return console.error("Error fetching events:",t),[]}},async updateEvent(r,t){try{if(await E.isDemoModeEnabled()){const d=t.trip_id||r.split("-")[0];return await _.updateEvent(d,r,t)!==null}const{error:n}=await w.from("trip_events").update(t).eq("id",r);return!n}catch(s){return console.error("Error updating event:",s),!1}},async deleteEvent(r,t){try{if(await E.isDemoModeEnabled())return t?await _.deleteEvent(t,r):(console.error("Trip ID required for demo mode event deletion"),!1);const{error:n}=await w.from("trip_events").delete().eq("id",r);return!n}catch(s){return console.error("Error deleting event:",s),!1}},convertToCalendarEvent(r){return{id:r.id,title:r.title,date:new Date(r.start_time),time:new Date(r.start_time).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),location:r.location,description:r.description,createdBy:r.created_by,include_in_itinerary:r.include_in_itinerary,event_category:r.event_category,source_type:r.source_type,source_data:r.source_data}},convertFromCalendarEvent(r,t){const s=new Date(r.date),[n,d]=r.time.split(":");return s.setHours(parseInt(n),parseInt(d)),{trip_id:t,title:r.title,description:r.description,start_time:s.toISOString(),location:r.location,event_category:r.event_category||"other",include_in_itinerary:r.include_in_itinerary,source_type:r.source_type||"manual",source_data:r.source_data||{}}}},re=r=>{const[t,s]=f.useState([]),[n,d]=f.useState(!1);f.useEffect(()=>{r&&a()},[r]);const a=async()=>{if(r){d(!0);try{const i=await j.getTripEvents(r);s(i)}catch(i){console.error("Error loading events:",i)}finally{d(!1)}}},c=async i=>{const o=await j.createEvent(i);return o&&s(g=>[...g,o]),o};return{events:t,loading:n,createEvent:c,createEventFromCalendar:async i=>{if(!r)return null;const o=j.convertFromCalendarEvent(i,r);return c(o)},updateEvent:async(i,o)=>{const g=await j.updateEvent(i,o);return g&&s(m=>m.map(p=>p.id===i?{...p,...o}:p)),g},deleteEvent:async i=>{const o=await j.deleteEvent(i,r);return o&&s(g=>g.filter(m=>m.id!==i)),o},refreshEvents:a,getCalendarEvents:()=>t.map(i=>j.convertToCalendarEvent(i))}},D=[{id:"accommodations",name:"Accommodations",icon:"ðŸ¨",color:"bg-blue-500"},{id:"food",name:"Food & Dining",icon:"ðŸ½ï¸",color:"bg-red-500"},{id:"transportation",name:"Transportation",icon:"ðŸš—",color:"bg-green-500"},{id:"fitness",name:"Fitness & Activities",icon:"ðŸ’ª",color:"bg-purple-500"},{id:"nightlife",name:"Nightlife & Entertainment",icon:"ðŸŒ™",color:"bg-indigo-500"},{id:"attractions",name:"Attractions & Sightseeing",icon:"ðŸŽ¯",color:"bg-yellow-500"},{id:"budget",name:"Budget & Expenses",icon:"ðŸ’°",color:"bg-emerald-500"}],se=(r,t)=>{const[s,n]=f.useState(null),[d,a]=f.useState(null);return{categories:D,filterCategory:s,setFilterCategory:n,selectedCategory:d,setSelectedCategory:a,selectCategory:o=>a(o),getCategoryInfo:o=>D.find(g=>g.id===o),getUserAssignedCategories:o=>r.filter(g=>g.assignedUsers.some(m=>m.id===o)).map(g=>g.categoryId),isUserLeadForCategory:(o,g)=>{const m=r.find(p=>p.categoryId===g);return(m==null?void 0:m.leadUserId)===o},filterEventsByCategory:o=>s?o.filter(g=>g.event_category===s):o,clearFilter:()=>n(null)}},ae=({categories:r,selectedFilter:t,onFilterChange:s})=>e.jsxs("div",{className:"bg-card/50 backdrop-blur-sm border border-border rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(W,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Filter by Category"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>s(null),className:`px-3 py-2 rounded-lg text-sm transition-colors ${t===null?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground hover:bg-secondary/80"}`,children:"All Categories"}),r.map(n=>e.jsxs("button",{onClick:()=>s(n.id),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm transition-colors ${t===n.id?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground hover:bg-secondary/80"}`,children:[e.jsx("span",{children:n.icon}),n.name]},n.id))]})]}),ne=({categories:r,onSelectCategory:t})=>e.jsxs("div",{className:"bg-card/50 backdrop-blur-sm border border-border rounded-2xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-4",children:"Quick Add Event"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:r.slice(0,6).map(s=>e.jsxs("button",{onClick:()=>t(s.id),className:"flex items-center gap-2 bg-secondary/50 hover:bg-secondary text-foreground px-3 py-2 rounded-lg transition-colors text-sm",children:[e.jsx("span",{children:s.icon}),s.name]},s.id))})]}),oe=({event:r,categoryInfo:t,assignment:s})=>e.jsx("div",{className:"bg-card border border-border rounded-lg p-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-lg",children:t==null?void 0:t.icon}),e.jsx("h4",{className:"font-medium text-foreground",children:r.title}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${t==null?void 0:t.color} text-white`,children:t==null?void 0:t.name})]}),e.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-3.5 w-3.5"}),r.time]}),r.location&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-3.5 w-3.5"}),r.location]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-3.5 w-3.5"}),"Added by You"]})]}),r.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:r.description})]})})}),ie=({events:r,selectedDate:t,assignments:s,getCategoryInfo:n})=>e.jsxs("div",{className:"bg-card/50 backdrop-blur-sm border border-border rounded-2xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-4",children:t?`Events for ${H(t,"EEEE, MMM d")}`:"Select a date to view events"}),r.length>0?e.jsx("div",{className:"space-y-3",children:r.map(d=>e.jsx(oe,{event:d,categoryInfo:n(d.event_category),assignment:s.find(a=>a.categoryId===d.event_category)},d.id))}):e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"text-muted-foreground text-sm",children:t?"No events scheduled for this day":"Select a date to view events"})})]}),le=({tripMembers:r,assignments:t,tripId:s})=>{const[n,d]=f.useState(new Date),[a,c]=f.useState(!1),{createEventFromCalendar:x,getCalendarEvents:h}=re(s),{categories:l,filterCategory:v,setFilterCategory:i,selectedCategory:o,setSelectedCategory:g,selectCategory:m,getCategoryInfo:p,filterEventsByCategory:u}=se(t),b=h(),N=n?(y=>{const S=b.filter(C=>C.date.toDateString()===y.toDateString());return u(S)})(n):[],B=async y=>{if(!n||!o)return;const S={id:"",title:y.title,date:n,time:y.time,location:y.location,description:y.description,createdBy:"",include_in_itinerary:!0,event_category:o,source_type:"manual",source_data:{}};try{await x(S)?(A.success("Event added successfully!"),c(!1),m(null)):A.error("Failed to add event. Please try again.")}catch(C){console.error("Error adding event:",C),A.error("Failed to add event. Please try again.")}},I=b.map(y=>y.date);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(ae,{categories:l,selectedFilter:v,onFilterChange:i}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl p-6",children:e.jsx(V,{mode:"single",selected:n,onSelect:d,className:"w-full",modifiers:{hasEvents:I},modifiersStyles:{hasEvents:{backgroundColor:"rgb(59 130 246 / 0.3)",color:"white",fontWeight:"bold"}}})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ne,{categories:l,onSelectCategory:y=>{m(y),c(!0)}}),e.jsx(ie,{events:N,selectedDate:n,assignments:t,getCategoryInfo:p})]})]}),a&&o&&e.jsx(ee,{category:l.find(y=>y.id===o),isOpen:a,onClose:()=>{c(!1),g(null)},onSubmit:B,selectedDate:n})]})},Ce=()=>{const{tripId:r}=O(),t=L(),[s,n]=f.useState([]),[d,a]=f.useState("assignments"),c=[{id:"1",name:"Joe",avatar:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=40&h=40&fit=crop&crop=face",email:"joe@example.com"},{id:"2",name:"Phil",avatar:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=40&h=40&fit=crop&crop=face",email:"phil@example.com"},{id:"3",name:"Stephanie",avatar:"https://images.unsplash.com/photo-1494790108755-2616b612b47c?w=40&h=40&fit=crop&crop=face",email:"stephanie@example.com"},{id:"4",name:"Elissa",avatar:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=40&h=40&fit=crop&crop=face",email:"elissa@example.com"},{id:"5",name:"Tara",avatar:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=40&h=40&fit=crop&crop=face",email:"tara@example.com"}],x=h=>{n(h)};return e.jsx("div",{className:"min-h-screen bg-black",children:e.jsxs("div",{className:"container mx-auto px-6 py-8 max-w-7xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("button",{onClick:()=>t(`/trip/${r}`),className:"flex items-center gap-3 text-gray-300 hover:text-white transition-colors group",children:[e.jsx("div",{className:"bg-gray-800 p-2 rounded-lg shadow-lg group-hover:shadow-yellow-500/20 transition-all border border-gray-700 hover:border-yellow-500/50",children:e.jsx(J,{size:20})}),e.jsx("span",{className:"font-medium",children:"Back to Trip"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>a("assignments"),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-colors ${d==="assignments"?"bg-yellow-500 text-black":"bg-gray-800 text-white hover:bg-gray-700"}`,children:[e.jsx(X,{size:16}),"Assignments"]}),e.jsxs("button",{onClick:()=>a("calendar"),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-colors ${d==="calendar"?"bg-yellow-500 text-black":"bg-gray-800 text-white hover:bg-gray-700"}`,children:[e.jsx(Y,{size:16}),"Calendar"]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Itinerary Management"}),e.jsx("p",{className:"text-gray-400",children:"Assign responsibilities and collaborate on your trip planning"})]}),d==="assignments"?e.jsx(Z,{tripMembers:c,assignments:s,onAssignmentChange:x}):e.jsx(le,{tripMembers:c,assignments:s,tripId:r||""})]})})};export{Ce as default};
